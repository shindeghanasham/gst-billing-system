<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: head('Admin Dashboard')">
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
.stat-card {
	border: none;
	border-radius: 15px;
	box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
	transition: transform 0.3s ease;
}

.stat-card:hover {
	transform: translateY(-5px);
}

.recent-activity {
	max-height: 400px;
	overflow-y: auto;
}
</style>
</head>
<body>
	<div th:replace="fragments/navbar :: navbar"></div>

	<div class="container-fluid mt-4">
		<!-- Flash Messages -->
		<div th:if="${message}"
			class="alert alert-success alert-dismissible fade show" role="alert">
			<span th:text="${message}"></span>
			<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
		</div>
		<div th:if="${error}"
			class="alert alert-danger alert-dismissible fade show" role="alert">
			<span th:text="${error}"></span>
			<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
		</div>

		<div class="row">
			<!-- Sidebar -->
			<div class="col-md-3">
				<div class="card">
					<div class="card-header bg-primary text-white">
						<h5 class="card-title mb-0">Admin Panel</h5>
					</div>
					<div class="list-group list-group-flush">
						<a th:href="@{/admin/dashboard}"
							class="list-group-item list-group-item-action active"> <i
							class="fas fa-tachometer-alt me-2"></i>Dashboard
						</a> <a th:href="@{/admin/users}"
							class="list-group-item list-group-item-action"> <i
							class="fas fa-users me-2"></i>User Management
						</a> <a th:href="@{/admin/invoices}"
							class="list-group-item list-group-item-action"> <i
							class="fas fa-file-invoice me-2"></i>All Invoices
						</a> <a th:href="@{/admin/customers}"
							class="list-group-item list-group-item-action"> <i
							class="fas fa-address-book me-2"></i>All Customers
						</a> <a th:href="@{/admin/products}"
							class="list-group-item list-group-item-action"> <i
							class="fas fa-boxes me-2"></i>All Products
						</a> <a th:href="@{/admin/statistics}"
							class="list-group-item list-group-item-action"> <i
							class="fas fa-chart-bar me-2"></i>System Statistics
						</a>
					</div>
				</div>
			</div>

			<!-- Main Content -->
			<div class="col-md-9">
				<div class="d-flex justify-content-between align-items-center mb-4">
					<h2>Admin Dashboard</h2>
					<div class="btn-group">
						<a th:href="@{/dashboard}" class="btn btn-outline-primary"> <i
							class="fas fa-user me-2"></i>User View
						</a>
					</div>
				</div>

				<!-- Statistics Cards -->
				<div class="row mb-4">
					<div class="col-xl-3 col-md-6 mb-4">
						<div class="card stat-card border-left-primary shadow h-100 py-2">
							<div class="card-body">
								<div class="row no-gutters align-items-center">
									<div class="col mr-2">
										<div
											class="text-xs font-weight-bold text-primary text-uppercase mb-1">
											Total Users</div>
										<div class="h5 mb-0 font-weight-bold text-gray-800"
											th:text="${totalUsers}">0</div>
									</div>
									<div class="col-auto">
										<i class="fas fa-users fa-2x text-gray-300"></i>
									</div>
								</div>
							</div>
						</div>
					</div>

					<div class="col-xl-3 col-md-6 mb-4">
						<div class="card stat-card border-left-success shadow h-100 py-2">
							<div class="card-body">
								<div class="row no-gutters align-items-center">
									<div class="col mr-2">
										<div
											class="text-xs font-weight-bold text-success text-uppercase mb-1">
											Total Revenue</div>
										<div class="h5 mb-0 font-weight-bold text-gray-800">
											₹<span
												th:text="${#numbers.formatDecimal(totalRevenue, 1, 2)}">0.00</span>
										</div>
									</div>
									<div class="col-auto">
										<i class="fas fa-rupee-sign fa-2x text-gray-300"></i>
									</div>
								</div>
							</div>
						</div>
					</div>

					<div class="col-xl-3 col-md-6 mb-4">
						<div class="card stat-card border-left-info shadow h-100 py-2">
							<div class="card-body">
								<div class="row no-gutters align-items-center">
									<div class="col mr-2">
										<div
											class="text-xs font-weight-bold text-info text-uppercase mb-1">
											Total Invoices</div>
										<div class="h5 mb-0 font-weight-bold text-gray-800"
											th:text="${totalInvoices}">0</div>
									</div>
									<div class="col-auto">
										<i class="fas fa-file-invoice fa-2x text-gray-300"></i>
									</div>
								</div>
							</div>
						</div>
					</div>

					<div class="col-xl-3 col-md-6 mb-4">
						<div class="card stat-card border-left-warning shadow h-100 py-2">
							<div class="card-body">
								<div class="row no-gutters align-items-center">
									<div class="col mr-2">
										<div
											class="text-xs font-weight-bold text-warning text-uppercase mb-1">
											Total Products</div>
										<div class="h5 mb-0 font-weight-bold text-gray-800"
											th:text="${totalProducts}">0</div>
									</div>
									<div class="col-auto">
										<i class="fas fa-boxes fa-2x text-gray-300"></i>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<!-- Charts Section -->


				<!-- Recent Activity -->
				<div class="row">
					<div class="col-lg-8">
						<div class="card shadow mb-4">
							<div class="card-header py-3">
								<h6 class="m-0 font-weight-bold text-primary">Recent
									Invoices</h6>
							</div>
							<div class="card-body recent-activity">
								<div th:if="${recentInvoices.empty}" class="text-center py-4">
									<p class="text-muted">No recent invoices found.</p>
								</div>
								<div th:each="invoice : ${recentInvoices}"
									class="mb-3 pb-3 border-bottom">
									<div class="d-flex justify-content-between align-items-center">
										<div>
											<h6 class="mb-1" th:text="${invoice.invoiceNumber}"></h6>
											<p class="mb-1 text-muted small">
												Customer: <span th:text="${invoice.customer.name}"></span> |
												Date: <span
													th:text="${#temporals.format(invoice.invoiceDate, 'dd/MM/yyyy')}"></span>
											</p>
										</div>
										<div class="text-end">
											<strong class="text-success">₹<span
												th:text="${#numbers.formatDecimal(invoice.totalAmount, 1, 2)}"></span></strong>
											<div>
												<small class="text-muted">by <span
													th:text="${invoice.user.username}"></span></small>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>

					<div class="col-lg-4">
						<div class="card shadow mb-4">
							<div class="card-header py-3">
								<h6 class="m-0 font-weight-bold text-primary">Quick Actions</h6>
							</div>
							<div class="card-body">
								<div class="d-grid gap-2">
									<a th:href="@{/admin/users}"
										class="btn btn-outline-primary btn-sm"> <i
										class="fas fa-users me-2"></i>Manage Users
									</a> <a th:href="@{/admin/invoices}"
										class="btn btn-outline-success btn-sm"> <i
										class="fas fa-file-invoice me-2"></i>View All Invoices
									</a> <a th:href="@{/admin/statistics}"
										class="btn btn-outline-info btn-sm"> <i
										class="fas fa-chart-bar me-2"></i>System Statistics
									</a> <a th:href="@{/invoices/create}"
										class="btn btn-outline-warning btn-sm"> <i
										class="fas fa-plus me-2"></i>Create Invoice
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div th:replace="admin/fragments/footer :: footer"></div>
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>